# 2D Top-Down RPG in Flutter: Game Design Document

## 1. Game Overview
**Title**: LumberjackRPG  
**Genre**: 2D Top-Down RPG  
**Platform**: Flutter (Mobile, Desktop, Web)  
**Description**: LumberjackRPG is a 2D top-down role-playing game built using Flutter and the Flame game engine. Players take on the role of a lumberjack exploring a procedurally generated world with diverse biomes (forest, mountain, cave, deep cave, water) and roads. The goal is to gather resources (wood and metal), craft better axes, and defeat biome-specific monsters to gain experience and level up.

## 2. Gameplay Mechanics

### 2.1 World Generation
- **Map Size**: 42x42 tiles (1344x1344 pixels, 32x32 pixels per tile).
- **Biomes**: Procedurally generated using Perlin noise (`frequency: 0.05`) for continuous clusters:
  - **Forest**: Green with tree-like features, home to basic woods (e.g., balsa, cedar) and monsters (e.g., wolf, boar).
  - **Mountain**: Gray with rocky features, contains harder woods (e.g., mahogany) and metals (e.g., iron, steel).
  - **Cave**: Dark gray with cave-like textures, hosts rare woods (e.g., black ironwood) and metals (e.g., tungsten).
  - **Deep Cave**: Dark slate gray with ominous features, has the rarest woods (e.g., snakewood) and metals (e.g., iridium).
  - **Water**: Blue with wavy lines, impassable, no resources or monsters.
  - **Road**: Brown dirt paths with center lines, extend from the spawn point (pixel coordinates `(50, 50)`, tile `(1, 1)`) to biome centers or random points, no resources or monsters.
- **Road Generation**: Roads are generated using a Manhattan-style pathfinding algorithm with randomness to create meandering paths, ensuring connectivity across biomes.
- **Resources**: Wood and metal resources are placed randomly (10% chance for wood, 5% for metal) in non-water/road tiles, tied to biome-specific types.
- **Monsters**: Spawned with a 5% chance per tile in non-water/road areas, with biome-specific types and levels (e.g., forest: wolf level 1, deep cave: dragon level 10).

### 2.2 Player Mechanics
- **Movement**: Players move tile-by-tile using WASD/arrow keys or tap controls. Movement is restricted to non-water tiles.
- **Resource Gathering**:
  - **Chopping Wood**: Tap or press spacebar on adjacent wood resources to reduce durability. When depleted, gain wood amount and 10 XP.
  - **Mining Metal**: Tap or press spacebar on adjacent metal resources to reduce durability. When depleted, gain metal amount and 15 XP.
- **Combat**: Tap or press spacebar on adjacent monsters to attack with the current axe’s damage. Monsters retaliate if not defeated. Defeating a monster grants `level * 20` XP.
- **Leveling**: Experience accumulates, with level-ups at `level * 100` XP, increasing max health by 10 and resetting health.
- **Crafting**: Use collected wood and metal to craft better axes (e.g., iron axe requires 10 wood, 5 iron).

### 2.3 Assets
- **Pre-Generated Assets**: The game uses pre-generated `.png` files (`usePreGeneratedAssets = true`) for fast loading (~50ms for a 42x42 map).
- **Map Tiles**: 32x32 pixels, derived from 64x64 images split into four sub-tiles (`_0_0`, `_0_1`, `_1_0`, `_1_1`) for variation. Biomes have distinct colors and features (e.g., forest: green with trees, road: brown with lines).
- **Resources**: 16x16 pixels, wood (tree-like) and metal (polygonal) sprites with biome-specific color adjustments (e.g., darker in caves).
- **Entities**: 32x32 pixels, player (green humanoid) and monsters (e.g., red bandit, gray wolf) with biome-specific designs.
- **Generation**: Assets are generated by `tools/generate_assets.dart` using Perlin noise for textures and biome-specific patterns.

## 3. Technical Implementation

### 3.1 Project Structure
```
LumberjackRPG/
├── docs/
│   └── GameDesignDocument.md
├── lib/
│   ├── lumberjack.dart
│   ├── crafting_system.dart
│   ├── game_map.dart
│   ├── wood.dart
│   ├── metal.dart
│   ├── axe.dart
│   ├── monster.dart
│   ├── constants.dart
│   ├── lumberjack_rpg.dart
│   ├── main.dart
├── tools/
│   └── generate_assets.dart
├── assets/
│   ├── map/
│   │   ├── forest_0_0.png
│   │   ├── ... (other map tiles, including road_0_0.png, ...)
│   ├── resources/
│   │   ├── balsa.png
│   │   ├── ... (other resources)
│   ├── entities/
│   │   ├── player.png
│   │   ├── ... (other entities)
└── pubspec.yaml
```

### 3.2 Key Classes
- **GameMap (game_map.dart)**: Generates a 42x42 map with Perlin noise for biomes, places roads from the spawn point, and distributes resources and monsters.
- **LumberjackRPG (lumberjack_rpg.dart)**: Main `FlameGame`, renders the map, player, resources, and monsters using pre-generated `.png` assets. Handles tap and keyboard input.
- **Lumberjack (lumberjack.dart)**: Manages player state (health, inventory, axe) and actions (chopping, mining, attacking).
- **Wood (wood.dart) / Metal (metal.dart)**: Resource classes with durability and amount, tied to biome-specific types.
- **Monster (monster.dart)**: Enemy class with health, damage, and level, tied to biomes.
- **Axe (axe.dart)**: Defines axe types (stone, iron, etc.) with durability and damage.
- **CraftingSystem (crafting_system.dart)**: Manages axe crafting recipes and resource consumption.
- **Constants (constants.dart)**: Defines `woodTypes` and `metalTypes` with biome mappings and properties.

### 3.3 Asset Generation
- **Script**: `tools/generate_assets.dart` creates `.png` files for map tiles (64x64, split into 32x32), resources (16x16), and entities (32x32).
- **Process**: Uses `image` package and Perlin noise (`flame_noise`) for textures. Outputs to `assets/map/`, `assets/resources/`, and `assets/entities/`.
- **Usage**: Run `dart run tools/generate_assets.dart` to generate assets, then commit to the repository.

### 3.4 Dependencies
- **flame: ^1.8.0**: Game engine for rendering and input handling.
- **flame_noise: ^0.1.0**: Perlin noise for procedural generation.
- **image: ^4.2.0**: Asset generation and runtime image processing.
- **vector_math: ^2.1.0**: Vector2 for positions and calculations.

## 4. Visual and Audio Design
- **Visual Style**: Pixel-art with 32x32 tiles, 16x16 resources, and 32x32 entities. Biomes have distinct colors and patterns (e.g., green forest, brown roads).
- **Map Rendering**: 1344x1344 pixel map (42x42 tiles) with continuous biome clusters and roads. Player starts at `(50, 50)` on a road tile.
- **Audio**: Currently placeholder; future implementation may include ambient biome sounds and sound effects for chopping, mining, and combat.

## 5. Future Enhancements
- **UI Overlays**: Add Flutter widgets for inventory, health, and minimap.
- **Road Improvements**: Implement branching roads, intersections, or A* pathfinding.
- **Biome Features**: Add rivers, villages, or larger biome clusters.
- **Level Ranges**: Add `levelRange` to `Wood` and `Metal` for progression.
- **Production Assets**: Use AI-generated pixel art for higher-quality sprites.
- **Persistence**: Save player progress and map state.

## 6. Setup Instructions
1. **Clone Repository**:
   ```bash
   git clone https://github.com/buzzedtop/LumberjackRPG.git
   cd LumberjackRPG
   ```
2. **Install Dependencies**:
   ```bash
   flutter pub get
   ```
3. **Generate Assets**:
   ```bash
   cd tools
   dart run generate_assets.dart
   cd ..
   git add assets/
   git commit -m "Add pre-generated assets"
   git push origin main
   ```
4. **Run Game**:
   ```bash
   flutter run
   ```
   - Displays a 42x42 tile map with biomes, roads, resources, and monsters.
   - Use WASD/arrow keys or tap to move, spacebar or tap to interact.

## 7. Implementation Notes
- **Asset Loading**: Pre-generated assets (`usePreGeneratedAssets = true`) ensure fast load times (~50ms).
- **Procedural Generation**: Perlin noise ensures continuous biomes; roads avoid water tiles.
- **Error Handling**: Missing assets cause Flame errors; run `generate_assets.dart` to resolve.
- **Customization**: Adjust map size in `lumberjack_rpg.dart`, noise frequency in `game_map.dart`, or asset visuals in `generate_assets.dart`.